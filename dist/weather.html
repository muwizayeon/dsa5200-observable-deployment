<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="generator" content="Observable Framework v1.13.3">
<title>Local Weather Forecast Project | Practice Weather Forcasting Infovis Dashboard</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="./_observablehq/theme-air,alt.7f878b97.css">
<link rel="preload" as="style" href="./_observablehq/stdlib/inputs.ea9fd553.css">
<link rel="preload" as="style" href="./_npm/leaflet@1.9.4/dist/leaflet.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_observablehq/theme-air,alt.7f878b97.css">
<link rel="stylesheet" type="text/css" href="./_observablehq/stdlib/inputs.ea9fd553.css">
<link rel="stylesheet" type="text/css" href="./_npm/leaflet@1.9.4/dist/leaflet.css">
<link rel="modulepreload" href="./_observablehq/client.0833912f.js">
<link rel="modulepreload" href="./_observablehq/runtime.e080113b.js">
<link rel="modulepreload" href="./_observablehq/stdlib.ec062f48.js">
<link rel="modulepreload" href="./_npm/d3@7.9.0/e780feca.js">
<link rel="modulepreload" href="./_npm/leaflet@1.9.4/721623d8.js">
<link rel="modulepreload" href="./_import/components/line_chart.3141c2f4.js">
<link rel="modulepreload" href="./_import/components/scatter_chart.fdb7fa45.js">
<link rel="modulepreload" href="./_import/components/bar_chart_100.e3b16513.js">
<link rel="modulepreload" href="./_import/components/bar_chart_110.5bddeb4b.js">
<link rel="modulepreload" href="./_observablehq/stdlib/inputs.d20f2cad.js">
<link rel="modulepreload" href="./_npm/htl@0.3.1/72f4716c.js">
<link rel="modulepreload" href="./_npm/isoformat@0.2.1/18cbf477.js">
<link rel="modulepreload" href="./_npm/d3-array@3.2.4/e93ca09f.js">
<link rel="modulepreload" href="./_npm/d3-axis@3.0.0/0f2de24d.js">
<link rel="modulepreload" href="./_npm/d3-brush@3.0.0/65eb105b.js">
<link rel="modulepreload" href="./_npm/d3-chord@3.0.1/7ef8fb2e.js">
<link rel="modulepreload" href="./_npm/d3-color@3.1.0/aeb57b94.js">
<link rel="modulepreload" href="./_npm/d3-contour@4.0.2/1d2aed74.js">
<link rel="modulepreload" href="./_npm/d3-delaunay@6.0.4/5ced1d52.js">
<link rel="modulepreload" href="./_npm/d3-dispatch@3.0.1/9ba9c7f3.js">
<link rel="modulepreload" href="./_npm/d3-drag@3.0.0/4202580c.js">
<link rel="modulepreload" href="./_npm/d3-dsv@3.0.1/9cffc2bd.js">
<link rel="modulepreload" href="./_npm/d3-ease@3.0.1/cdd7e898.js">
<link rel="modulepreload" href="./_npm/d3-fetch@3.0.1/b4e2ad9a.js">
<link rel="modulepreload" href="./_npm/d3-force@3.0.0/5e804d15.js">
<link rel="modulepreload" href="./_npm/d3-format@3.1.0/86074ef6.js">
<link rel="modulepreload" href="./_npm/d3-geo@3.1.1/40599fb3.js">
<link rel="modulepreload" href="./_npm/d3-hierarchy@3.1.2/e49e792c.js">
<link rel="modulepreload" href="./_npm/d3-interpolate@3.0.1/8d1e5425.js">
<link rel="modulepreload" href="./_npm/d3-path@3.1.0/20d3f133.js">
<link rel="modulepreload" href="./_npm/d3-polygon@3.0.1/7553081f.js">
<link rel="modulepreload" href="./_npm/d3-quadtree@3.0.1/0dfd751c.js">
<link rel="modulepreload" href="./_npm/d3-random@3.0.1/3c90ee06.js">
<link rel="modulepreload" href="./_npm/d3-scale@4.0.2/843b6a76.js">
<link rel="modulepreload" href="./_npm/d3-scale-chromatic@3.1.0/ba24c2e7.js">
<link rel="modulepreload" href="./_npm/d3-selection@3.0.0/4d94e5b7.js">
<link rel="modulepreload" href="./_npm/d3-shape@3.2.0/6d3a6726.js">
<link rel="modulepreload" href="./_npm/d3-time@3.1.0/9f03c579.js">
<link rel="modulepreload" href="./_npm/d3-time-format@4.1.0/07c9626f.js">
<link rel="modulepreload" href="./_npm/d3-timer@3.0.1/b58a267d.js">
<link rel="modulepreload" href="./_npm/d3-transition@3.0.1/004da2ac.js">
<link rel="modulepreload" href="./_npm/d3-zoom@3.0.0/b5786b3f.js">
<link rel="modulepreload" href="./_npm/internmap@2.0.3/e08981d9.js">
<link rel="modulepreload" href="./_npm/delaunator@5.0.1/02d43215.js">
<link rel="modulepreload" href="./_npm/robust-predicates@3.0.2/aa00730b.js">
<link rel="icon" href="./_file/observable.1af93621.png" type="image/png" sizes="32x32">
<script type="module">

import {define} from "./_observablehq/client.0833912f.js";
import {registerFile} from "./_observablehq/stdlib.ec062f48.js";

registerFile("./data/forecastcupertino.json", {"name":"./data/forecastcupertino.json","mimeType":"application/json","path":"./_file/data/forecastcupertino.f8a21818.json","lastModified":1750348071747,"size":83386});
registerFile("./data/forecastlees.json", {"name":"./data/forecastlees.json","mimeType":"application/json","path":"./_file/data/forecastlees.7ca66ad0.json","lastModified":1750347859628,"size":84493});
registerFile("./data/forecastnewyork.json", {"name":"./data/forecastnewyork.json","mimeType":"application/json","path":"./_file/data/forecastnewyork.b7ca5d1c.json","lastModified":1750348767907,"size":85070});
registerFile("./data/forecastsanfran.json", {"name":"./data/forecastsanfran.json","mimeType":"application/json","path":"./_file/data/forecastsanfran.429ae361.json","lastModified":1750348068606,"size":83718});
registerFile("./data/forecaststlouis.json", {"name":"./data/forecaststlouis.json","mimeType":"application/json","path":"./_file/data/forecaststlouis.5d23954e.json","lastModified":1750347874520,"size":84104});

define({id: "10465193", outputs: ["d3"], body: async () => {
const d3 = await import("./_npm/d3@7.9.0/e780feca.js");
// Import D3

return {d3};
}});

define({id: "9d985d6f", inputs: ["Inputs","view"], outputs: ["locations","geoSelect","selectedVal"], body: (Inputs,view) => {
const locations = ["Lee's Summit", "New York", "St. Louis", "San Francisco", "Cupertino"];
const geoSelect = Inputs.select(locations, {value: "Lee's Summit", label: "City"});
// view function returns its associated DOM element.
// So it can access the value a user requests
const selectedVal = view(geoSelect);
return {locations,geoSelect,selectedVal};
}});

define({id: "7d1686ad", inputs: ["selectedVal","FileAttachment"], outputs: ["forecast"], body: (selectedVal,FileAttachment) => {
// Load original dataset
let forecast;

if (selectedVal == "Lee's Summit") {
    forecast = FileAttachment("./data/forecastlees.json").json();
} else if (selectedVal == "New York") {
    forecast = FileAttachment("./data/forecastnewyork.json").json();
    console.log(forecast)
} else if (selectedVal == "St. Louis") {
    forecast = FileAttachment("./data/forecaststlouis.json").json();
} else if (selectedVal == "San Francisco") {
    forecast = FileAttachment("./data/forecastsanfran.json").json();
} else {
    forecast = FileAttachment("./data/forecastcupertino.json").json();
}
return {forecast};
}});

define({id: "b51ef9c1", inputs: ["forecast"], outputs: ["lons","lats","leafletLatLon"], body: (forecast) => {
const lons = [];
const lats = [];
forecast.geometry.coordinates[0].forEach(loc => lons.push(loc[0]));
forecast.geometry.coordinates[0].forEach(loc => lats.push(loc[1]));
// Create the centroid of each city
// '...' is the spread operator: it spreads the array into individual arguments
// e.g., lats = [34.5, 42.1, 39.0]; then Math.min(...lats) -> Math.min(34.5, 42.1, 39.0)
const leafletLatLon = [
    Math.min(...lats) + (Math.max(...lats) - Math.min(...lats))/2,
    Math.min(...lons) + (Math.max(...lons) - Math.min(...lons))/2
];

return {lons,lats,leafletLatLon};
}});

define({id: "6cf86ac6", outputs: ["findMostFrequentDirection"], body: () => {
// Function to find the mode of categorical variables
function findMostFrequentDirection(directions) {
    // Extract unique words using Set object
    const uniqueDirects = new Set(directions);

    // Sort words
    directions.sort()

    let highestCount = 0;
    let mostFrequent = [];

    uniqueDirects.forEach(direct => {
        // Count direction
        const start = directions.indexOf(direct);
        const end = directions.lastIndexOf(direct);
        const count = end - start + 1;

        // Update highest count and most frequent direction
        if (count > highestCount) {
            highestCount = count;
            mostFrequent = [direct];
        }
        // Add word to most frequent list if it has
        // the same count as the current highest
        if (count == highestCount && !mostFrequent.includes(direct)) {
            mostFrequent.push(direct);
        }
    });

    return mostFrequent;
}
return {findMostFrequentDirection};
}});

define({id: "9d417f42", inputs: ["forecast","d3","findMostFrequentDirection"], outputs: ["temperatures","precipitations","windSpeeds","windDirects","finDat","numPattern","numSearch","candidates","labelDicts","arrAvg","avgPrecp","avgWindSpeed","roundFormat","modeDirect","dateParser","xAccessor"], body: (forecast,d3,findMostFrequentDirection) => {
// Define each column list of data we are looking at
const temperatures = [];
const precipitations = [];
const windSpeeds = [];
const windDirects = [];
const finDat = [];

// RegEx Patter to extract wind speed
const numPattern = /\d+/;
const numSearch = string => {let retVal = string.match(numPattern); return Number(retVal[0])};

// Original datasets
const candidates = forecast.properties.periods;

// Create label dictionaries
const labelDicts = {
    "time": "Time",
    "temperature": "Hourly Temperature (&deg;F)",
    "probPrec": "Precipitation (%)",
    "windSpeed": "Wind Speed (mph)",
    "windDirect": "Wind Direction",
    "isDaytime": "Daytime (1: Yes, 0: No)",
    "dewPoint": "Dew Point (&deg;C)",
    "relativeHumidity": "Relative Humidity (%)",
};

// Extract necessary data variables
candidates.forEach(obj => {temperatures.push(obj.temperature)});
candidates.forEach(obj => {precipitations.push(obj.probabilityOfPrecipitation.value)});
candidates.forEach(obj => {windSpeeds.push(numSearch(obj.windSpeed))});
candidates.forEach(obj => {windDirects.push(obj.windDirection)});

// Finalized reshaped dataset
for (let i = 0;i < forecast.properties.periods.length;i++) {
    finDat.push(
        {
            "time": candidates[i].startTime,
            "temperature": temperatures[i],
            "probPrec": precipitations[i],
            "windSpeed": windSpeeds[i],
            "windDirect": windDirects[i],
            "isDaytime": candidates[i].isDaytime==true?1:0,
            "dewPoint": candidates[i].dewpoint.value,
            "relativeHumidity": candidates[i].relativeHumidity.value,
        }
    );
}

// Calculate, average precipitation, wind speed, most frequent wind direction
const arrAvg = arr => {return arr.reduce((a, b) => a + b, 0) / arr.length};
let avgPrecp = arrAvg(precipitations);
let avgWindSpeed = arrAvg(windSpeeds);
let roundFormat = d3.format(".1f");
let modeDirect = findMostFrequentDirection(windDirects);

// Date parser and accessor
const dateParser = d3.timeParse("%Y-%m-%dT%H:%M:%S%Z")
const xAccessor = d => dateParser(d["startTime"])

// Display some of data
// display(xAccessor(forecast.properties.periods[0]));
// display(candidates[0]);
return {temperatures,precipitations,windSpeeds,windDirects,finDat,numPattern,numSearch,candidates,labelDicts,arrAvg,avgPrecp,avgWindSpeed,roundFormat,modeDirect,dateParser,xAccessor};
}});

define({id: "277b0bdb", inputs: ["display","leafletLatLon","forecast"], outputs: ["L","div","map","targetArea"], body: async (display,leafletLatLon,forecast) => {
const L = await import("./_npm/leaflet@1.9.4/721623d8.js");
// Load leaflet library for geospatial analysis

// Add the geographical location of data
const div = display(document.createElement("div"));
div.style = "height: 400px; border-radius: 8px;";

// Map
const map = L.map(div)
    .setView(leafletLatLon, 13);

L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png", {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'})
    .addTo(map)
// Polygons
const targetArea = [];
forecast.geometry.coordinates[0].forEach(element => {
    targetArea.push([element[1], element[0]])
    }
)
L.polygon(targetArea).addTo(map)
return {L,div,map,targetArea};
}});

define({id: "a33f306b", mode: "inline", inputs: ["temperatures","display"], body: async (temperatures,display) => {
display(await(
Math.min(...temperatures)
))
}});

define({id: "23fa3be6", mode: "inline", inputs: ["temperatures","display"], body: async (temperatures,display) => {
display(await(
Math.max(...temperatures)
))
}});

define({id: "3f27628f", mode: "inline", inputs: ["roundFormat","avgPrecp","display"], body: async (roundFormat,avgPrecp,display) => {
display(await(
roundFormat(avgPrecp)
))
}});

define({id: "25b5b063", mode: "inline", inputs: ["modeDirect","display"], body: async (modeDirect,display) => {
display(await(
modeDirect.join('/')
))
}});

define({id: "7674ab1a", mode: "inline", inputs: ["roundFormat","avgWindSpeed","display"], body: async (roundFormat,avgWindSpeed,display) => {
display(await(
roundFormat(avgWindSpeed)
))
}});

define({id: "f6a03c96", inputs: ["d3","resize","finDat"], outputs: ["drawLineChart","chartContainer","tempLine"], body: async (d3,resize,finDat) => {
const {drawLineChart} = await import("./_import/components/line_chart.3141c2f4.js");
const chartContainer = d3.select("#card00");
chartContainer.selectAll("*").remove();
const tempLine = resize(
    (width, height) => drawLineChart(
        finDat, 
        "temperature", 
        "time", 
        width,
        height
    )
)
d3.select("#card00").node().appendChild(tempLine)
return {drawLineChart,chartContainer,tempLine};
}});

define({id: "631f9cf2", inputs: ["resize","finDat","labelDicts","d3"], outputs: ["drawScatter","scatter"], body: async (resize,finDat,labelDicts,d3) => {
const {drawScatter} = await import("./_import/components/scatter_chart.fdb7fa45.js");
const scatter = resize(
   width => drawScatter(
    finDat, 
    "temperature", 
    "relativeHumidity", 
    "isDaytime", 
    width,
    labelDicts,
    "#tooltip10"
    )
)
d3.select('#card10').node().appendChild(scatter)
return {drawScatter,scatter};
}});

define({id: "59d2b318", inputs: ["resize","finDat","labelDicts","d3"], outputs: ["drawBars100","histbar00"], body: async (resize,finDat,labelDicts,d3) => {
const {drawBars100} = await import("./_import/components/bar_chart_100.e3b16513.js");
const histbar00 = resize(
    width => drawBars100(
        finDat,
        "temperature",
        width,
        labelDicts,
        "#tooltip100",
    )
)
d3.select("#card100").node().appendChild(histbar00)
return {drawBars100,histbar00};
}});

define({id: "498f9815", inputs: ["resize","finDat","labelDicts","d3"], outputs: ["drawBars110","histbar10"], body: async (resize,finDat,labelDicts,d3) => {
const {drawBars110} = await import("./_import/components/bar_chart_110.5bddeb4b.js");
const histbar10 = resize(
    width => drawBars110(
        finDat,
        "relativeHumidity",
        width,
        labelDicts,
        "#tooltip110",
    )
)
d3.select("#card110").node().appendChild(histbar10)

return {drawBars110,histbar10};
}});

define({id: "8c503982", inputs: ["d3","geoSelect","tempLine","scatter","histbar00","histbar10"], outputs: ["removePrevious"], body: (d3,geoSelect,tempLine,scatter,histbar00,histbar10) => {
let removePrevious = d3.select(geoSelect).on('change', event => {
    d3.select('#card00').node().removeChild(tempLine)
    d3.select('#card10').node().removeChild(scatter)
    d3.select("#card100").node().removeChild(histbar00)
    d3.select("#card110").node().removeChild(histbar10)
})
return {removePrevious};
}});

</script>
</head>
<body>
<input id="observablehq-sidebar-toggle" type="checkbox" title="Toggle sidebar">
<label id="observablehq-sidebar-backdrop" for="observablehq-sidebar-toggle"></label>
<nav id="observablehq-sidebar">
  <ol>
    <label id="observablehq-sidebar-close" for="observablehq-sidebar-toggle"></label>
    <li class="observablehq-link"><a href="./">Practice Weather Forcasting Infovis Dashboard</a></li>
  </ol>
  <ol>
    <li class="observablehq-link"><a href="./example-dashboard">Example dashboard</a></li>
    <li class="observablehq-link"><a href="./example-report">Example report</a></li>
    <li class="observablehq-link observablehq-link-active"><a href="./weather">Local Weather Forecast Project</a></li>
  </ol>
</nav>
<script>{const e=document.querySelector("#observablehq-sidebar"),o=document.querySelector("#observablehq-sidebar-toggle"),r=sessionStorage.getItem("observablehq-sidebar");r?o.checked=r==="true":o.indeterminate=!0;for(const t of document.querySelectorAll("#observablehq-sidebar summary")){const s=t.parentElement;switch(sessionStorage.getItem(`observablehq-sidebar:${t.textContent}`)){case"true":s.open=!0;break;case"false":s.classList.contains("observablehq-section-active")||(s.open=!1);break}}addEventListener("beforeunload",()=>sessionStorage.setItem("observablehq-sidebar-scrolly",`${e.scrollTop}`));const a=sessionStorage.getItem("observablehq-sidebar-scrolly");a!=null&&(e.style.cssText="overflow: hidden;",e.scrollTop=+a,e.style.cssText="");}</script>
<div id="observablehq-center">
<aside id="observablehq-toc" data-selector="h1:not(:first-of-type)[id], h2:first-child[id], :not(h1) + h2[id]">
<nav>
</nav>
</aside>
<main id="observablehq-main" class="observablehq">
<!--Set a predefined theme to an individual page 
"air" is the default light mode theme but 'alt' swaps
the page and card background colors.-->
<!-- CSS Style -->
<link rel="stylesheet" href="./_file/dashboard_styles.a48847b4.css">
<h1 id="local-weather-forecast-project" tabindex="-1"><a class="observablehq-header-anchor" href="#local-weather-forecast-project">Local Weather Forecast Project</a></h1>
<div class="observablehq observablehq--block"><!--:10465193:--></div>
<div class="observablehq observablehq--block"><!--:9d985d6f:--></div>
<div class="observablehq observablehq--block"><!--:7d1686ad:--></div>
<div class="observablehq observablehq--block"><!--:b51ef9c1:--></div>
<div class="observablehq observablehq--block"><!--:6cf86ac6:--></div>
<div class="observablehq observablehq--block"><!--:9d417f42:--></div>
<div class="observablehq observablehq--block"><!--:277b0bdb:--></div>
<div class="grid grid-cols-3">
    <div class="card">
        <h2>Temperature Range</h2>
        <span class="big">
        <observablehq-loading></observablehq-loading><!--:a33f306b:-->°F - <observablehq-loading></observablehq-loading><!--:23fa3be6:-->°F
        </span>
    </div>
    <div class="card">
        <h2>Average Precipitation</h2>
        <span class="big"><observablehq-loading></observablehq-loading><!--:3f27628f:--> %</span>
    </div>
    <div class="card">
        <h2>Average Wind Speed</h2>
        <span class="big"><observablehq-loading></observablehq-loading><!--:25b5b063:--> <observablehq-loading></observablehq-loading><!--:7674ab1a:--> mph</span>
    </div>
</div>
<div class="grid grid-cols-1" ;="" style="grid-auto-rows: 600px; position: relative" id="wrapper00">
    <div class="card" ;="" id="card00">
        <div id="tooltip00" ;="" class="tooltip">
            <div class="tooltip-date" ;="">
                <span id="date" ;=""></span>
            </div>
            <div class="tooltip-temperature" ;="">
                Maximum Temperature: <span id="temperature" ;=""></span>
            </div>
        </div>
    </div>
</div>
<div class="observablehq observablehq--block"><!--:f6a03c96:--></div>
<div class="grid grid-cols-2" ;="" id="wrapper01" style="position: relative;">
    <div class="card grid-rowspan-2" ;="" id="card10">
        <div id="tooltip10" ;="" class="tooltip">
            <div class="tooltip-scatTime" ;="">
                <span id="scatTime" ;=""></span>
            </div>
            <div class="tooltip-scatYmetric" ;="">
                Y: <span id="scatYmetric" ;=""></span>
            </div>
            <div class="tooltip-scatXmetric" ;="">
                X: <span id="scatXmetric" ;=""></span>
            </div>
            <div class="tooltip-scatCmetric" ;="">
                Color: <span id="scatCmetric" ;=""></span>
            </div>
        </div>
    </div>
    <div class="card" ;="" id="card100">
        <div id="tooltip100" ;="" class="tooltip">
            <div class="tooltip-range" ;="">
                X: <span id="range" ;=""></span>
            </div>
            <div class="tooltip-value" ;="">
                Count: <span id="count" ;=""></span> hours
            </div>
        </div>
    </div>
    <div class="card" ;="" id="card110">
        <div id="tooltip110" ;="" class="tooltip">
             <div class="tooltip-range" ;="">
                X: <span id="range" ;=""></span>
            </div>
            <div class="tooltip-value" ;="">
                Count: <span id="count" ;=""></span> hours
            </div>
        </div>
    </div>
</div>
<div class="observablehq observablehq--block"><!--:631f9cf2:--></div>
<div class="observablehq observablehq--block"><!--:59d2b318:--></div>
<div class="observablehq observablehq--block"><!--:498f9815:--></div>
<div class="observablehq observablehq--block"><!--:8c503982:--></div>
</main>
<footer id="observablehq-footer">
<nav><a rel="prev" href="./example-report"><span>Example report</span></a></nav>
<div>Built with <a href="https://observablehq.com/" target="_blank" rel="noopener noreferrer">Observable</a> on <a title="2025-06-19T11:08:16">Jun 19, 2025</a>.</div>
</footer>
</div>
</body>
</html>
